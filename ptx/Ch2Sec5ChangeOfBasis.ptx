<section xml:id="Ch2Sec5ChangeOfBasis">
  <title>Change of basis</title>

  <objectives>
    <ul>
      <li>How does the coordinate vector change if we use a different basis to compute it?</li>
    </ul>
  </objectives>

<!--
  <introduction>
    <figure>
        <caption>Video recording for <xref ref="Ch2Sec5ChangeOfBasis"/>.</caption>
        <video source="https://learn.sun.ac.za/pluginfile.php/1653776/mod_folder/content/0/Lec15ChangeOfBasis.mp4" width="70%" preview="../latex/images/preview-doc-cam.jpg" onerror="this.src='Default.jpg'" />
    </figure>
  </introduction>
-->

  <subsection>
    <title>Coordinate vectors are different in different bases</title>
    <p>
      Suppose that <m>\basis{B} = \left\{ \ve{b}_1, \ve{b}_2 \right\}</m> and
      <m>\basis{C} = \left\{ \ve{c}_1, \ve{c}_2 \right\}</m> are two different bases for <m>\mathbb{R}^2</m>,
      shown below:
    </p>
    <figure xml:id="w_in_different_bases">
      <caption>Two different bases for <m>\mathbb{R}^2</m></caption>

      <sidebyside width="30%">
        <figure>
          <caption>The basis <m>\basis{B} = \left\{ \ve{b}_1, \ve{b}_2 \right\}</m></caption>
          <image>
            <latex-image>
              <![CDATA[\begin{tikzpicture}[scale=0.8]
              \clip (-2,-1) rectangle (4,4);
              \draw[->] (-2,0) -- (2,0);
              \draw[->] (0,-1) -- (0,3);
              \draw[very thick, primaryColor, ->] (0,0) -- node[above] {\(\ve{b}_1\)} (2,1);
              \draw[very thick, primaryColor, ->] (0,0) -- node[pos=1.3] {\(\ve{b}_2\)} (1,2);\end{tikzpicture}]]>
            </latex-image>
          </image>
        </figure>

        <figure>
          <caption>The basis <m>\basis{C} = \left\{ \ve{c}_1, \ve{c}_2 \right\}</m>.</caption>
          <image>
            <latex-image>
              <![CDATA[\begin{tikzpicture}[scale=0.8]
              \clip (-2,-1) rectangle (4,4);
              \draw[->] (-2,0) -- (2,0);
              \draw[->] (0,-1) -- (0,3);
              \draw[very thick, secondaryColor, ->] (0,0) -- node[above] {\(\ve{c}_1\)} (1,0);
              \draw[very thick, secondaryColor, ->] (0,0) -- node[above] {\(\ve{c}_2\)} (-1,1);\end{tikzpicture}]]>
            </latex-image>
          </image>
        </figure>
      </sidebyside>
    </figure>

    <p>
      Suppose we are given a vector <m>\ve{w} \in \mathbb{R}^2</m>:
    </p>

    <image width="30%">
      <latex-image>
        <![CDATA[\begin{tikzpicture}[scale=0.8]
        \draw[->] (-4,0) -- (0.5,0);
        \draw[->] (0,-1) -- (0,3);
        \draw[thick, ->] (0,0) -- node[above] {\(\ve{w}\)} (-4, 1);\end{tikzpicture}]]>
      </latex-image>
    </image>

    <p>
      We would like to compute the coordinate vector of the <em>same</em>
      vector <m>\ve{w}</m> with respect to the two different bases
      <m>\basis{B}</m> and <m>\basis{C}</m>.
    </p>

    <p>
      For this particular <m>\ve{w}</m>, from <xref ref="w_in_b_basis"/>,
      we see that in terms of the basis <m>\basis{B}</m>, we have
      <men>
        \ve{w} = -3 \ve{b}_1 + 2 \ve{b}_2 \qquad \therefore \, [\ve{w}]_\basis{B} = \begin{bmatrix} -3 \\ 2   \end{bmatrix} \,
      </men>.
    </p>

    <p>
      On the other hand, in terms of the basis <m>\basis{C}</m>, we see from <xref ref="w_in_c_basis"/> that
      <men xml:id="correct_exp_w">
        \ve{w} = \ve{c}_1 - 3\ve{c}_2 \qquad \therefore \, [\ve{w}]_\basis{C} = \begin{bmatrix} 1 \\ -3   \end{bmatrix}
      </men>.
    </p>

    <sidebyside widths="47% 6% 47%">
      <figure xml:id="w_in_b_basis">
      <caption> <m>\ve{w} = -3 \ve{b}_1 + 2 \ve{b}_2</m></caption>

      <image>
        <latex-image>
          <![CDATA[\begin{tikzpicture}[scale=0.5]
          \clip (-5,-2) rectangle (4,3.5);
          \draw[primaryColor, dotted] (-9, -9) -- (3, -3);
          \draw[primaryColor, dotted] (-8, -7) -- (4, -1);
          \draw[primaryColor, dotted] (-7, -5) -- (5, 1);
          \draw[primaryColor, dotted] (-6, -3) -- (6, 3);
          \draw[primaryColor, dotted] (-5, -1) -- (7, 5);
          \draw[primaryColor, dotted] (-4, 1) -- (8, 7);
          \draw[primaryColor, dotted] (-3, 3) -- (9, 9);

          \draw[primaryColor, dotted] (-9, -9) -- (-3, 3);
          \draw[primaryColor, dotted] (-7, -8) -- (-1, 4);
          \draw[primaryColor, dotted] (-5, -7) -- (1, 5);
          \draw[primaryColor, dotted] (-3, -6) -- (3, 6);
          \draw[primaryColor, dotted] (-1, -5) -- (5, 7);
          \draw[primaryColor, dotted] (1, -4) -- (7, 8);
          \draw[primaryColor, dotted] (3, -3) -- (9, 9);

          \draw[very thick, primaryColor, ->] (0,0) -- node[pos=1.3] {\(\ve{b}_1\)} (2,1);
          \draw[very thick, primaryColor, ->] (0,0) -- node[pos=1.3] {\(\ve{b}_2\)} (1,2);
          \draw[thick, ->] (0,0) -- node[above] {\(\ve{w}\)} (-4,1);\end{tikzpicture}]]>
        </latex-image>
      </image>
    </figure>

  <figure xml:id="w_in_c_basis">
    <caption> <m>\ve{w} = \ve{c}_1 - 3 \ve{c}_2</m> </caption>
      <image>
        <latex-image>
          <![CDATA[\begin{tikzpicture}[scale=0.5]
          \clip (-5,-2) rectangle (4,3.5);
          \draw[secondaryColor, dotted] (-8, 4) -- (-1, -3);
          \draw[secondaryColor, dotted] (-7, 4) -- (0, -3);
          \draw[secondaryColor, dotted] (-6, 4) -- (1, -3);
          \draw[secondaryColor, dotted] (-5, 4) -- (2, -3);
          \draw[secondaryColor, dotted] (-4, 4) -- (3, -3);
          \draw[secondaryColor, dotted] (-3, 4) -- (4, -3);
          \draw[secondaryColor, dotted] (-2, 4) -- (5, -3);
          \draw[secondaryColor, dotted] (-1, 4) -- (6, -3);
          \draw[secondaryColor, dotted] ( 0, 4) -- (7, -3);

          \draw[secondaryColor, dotted] (-7, 3) -- (1, 3);
          \draw[secondaryColor, dotted] (-6, 2) -- (2, 2);
          \draw[secondaryColor, dotted] (-5, 1) -- (3, 1);
          \draw[secondaryColor, dotted] (-4, 0) -- (4, 0);
          \draw[secondaryColor, dotted] (-3, -1) -- (5, -1);
          \draw[secondaryColor, dotted] (-2, -2) -- (6, -2);
          \draw[secondaryColor, dotted] (-1, -3) -- (7, -3);

          \draw[very thick, secondaryColor, ->] (0,0) -- node[pos=1.6] {\(\ve{c}_2\)} (1,0);
          \draw[very thick, secondaryColor, ->] (0,0) -- node[pos=1.6] {\(\ve{c}_1\)} (-1,1);
          \draw[thick, ->] (0,0) -- node[above] {\(\ve{w}\)} (-4,1);\end{tikzpicture}]]>
        </latex-image>
      </image>
    </figure>
  </sidebyside>

    <p>
      So, the <em>same</em> vector <m>\ve{w}</m> has different coordinate vectors
      <m>[\ve{w}]_\basis{B}</m> and
      <m>[\ve{w}]_\basis{C}</m> with respect to the bases
      <m>\basis{B}</m> and <m>\basis{C}</m>!
    </p>
  </subsection>

  <subsection>
    <title>Changing from one basis to another</title>
    <p>
      Now, suppose we know the bases <m>\basis{B}</m> and <m>\basis{C}</m>, and we know the coordinate vector <m>[\ve{w}]_\basis{B}</m> of <m>\ve{w}</m> in the basis <m>\basis{B}</m>,
      <me>
        [\ve{w}]_\basis{B} = \begin{bmatrix} -3 \\ 2 \end{bmatrix}
      </me>,
      that is, <m>\ve{w} = -3 \ve{b}_1 + 2 \ve{b}_2</m>.
      How can we compute <m>[\ve{w}]_\basis{C}</m>,
      the coordinate vector of <m>\ve{w}</m> in the basis <m>\basis{C}</m>?
    </p>

    <p>
      The best way is to express each vector in the basis
      <m>\basis{B}</m> as a linear combination of the basis vectors in <m>\basis{C}</m>.
      In the next figure, the vectors <m>\ve{b}_1</m> and
      <m>\ve{b}_2</m> are displayed against the background of integral linear combinations of the basis <m>\basis{C}</m>:
    </p>

      <image width="60%">
        <latex-image>
          <![CDATA[\begin{tikzpicture}[scale=0.5]
          \clip (-5,-2) rectangle (4,3.5);
          \draw[secondaryColor, dotted] (-8, 4) -- (-1, -3);
          \draw[secondaryColor, dotted] (-7, 4) -- (0, -3);
          \draw[secondaryColor, dotted] (-6, 4) -- (1, -3);
          \draw[secondaryColor, dotted] (-5, 4) -- (2, -3);
          \draw[secondaryColor, dotted] (-4, 4) -- (3, -3);
          \draw[secondaryColor, dotted] (-3, 4) -- (4, -3);
          \draw[secondaryColor, dotted] (-2, 4) -- (5, -3);
          \draw[secondaryColor, dotted] (-1, 4) -- (6, -3);
          \draw[secondaryColor, dotted] ( 0, 4) -- (7, -3);

          \draw[secondaryColor, dotted] (-7, 3) -- (1, 3);
          \draw[secondaryColor, dotted] (-6, 2) -- (2, 2);
          \draw[secondaryColor, dotted] (-5, 1) -- (3, 1);
          \draw[secondaryColor, dotted] (-4, 0) -- (4, 0);
          \draw[secondaryColor, dotted] (-3, -1) -- (5, -1);
          \draw[secondaryColor, dotted] (-2, -2) -- (6, -2);
          \draw[secondaryColor, dotted] (-1, -3) -- (7, -3);

          \draw[very thick, secondaryColor, ->] (0,0) -- node[pos=1.6] {\(\ve{c}_2\)} (1,0);
          \draw[very thick, secondaryColor, ->] (0,0) -- node[pos=1.6] {\(\ve{c}_1\)} (-1,1);
          \draw[very thick, primaryColor, ->] (0,0) -- node[pos=1.3] {\(\ve{b}_1\)} (2,1);
          \draw[very thick, primaryColor, ->] (0,0) -- node[pos=1.3] {\(\ve{b}_2\)} (1,2);\end{tikzpicture}]]>
        </latex-image>
      </image>

    <p>
      We read off that:
      <mdn>
        <mrow xml:id="b_in_terms_of_c">\ve{b}_1 \amp = \ve{c}_1 + 3 \ve{c}_2</mrow>
        <mrow xml:id="b_in_terms_of_c_2">\ve{b}_2 \amp = 2 \ve{c}_1 + 3 \ve{c}_2</mrow>
      </mdn>
    </p>

    <p>
      Therefore, we compute:
      <md>
        <mrow>\ve{w} \amp = -3 \ve{b}_1 + 2 \ve{b}_2</mrow>
        <mrow>\amp = -3 (\ve{c}_1 + 3 \ve{c}_2) + 2(2 \ve{c}_1 + 3 \ve{c}_2)</mrow>
        <mrow>\amp = \ve{c}_1 - 3 \ve{c}_2</mrow>
      </md>
    </p>

    <p>
      From this we read off that
      <men xml:id="w_in_basis_C">
        [\ve{w}]_\basis{C} = \begin{bmatrix} 1 \\ -3 \end{bmatrix}
      </men>
      which is the right answer, as we know from <xref ref="correct_exp_w" />.
    </p>

    <p>
      In fact, this calculation can be phrased in terms of matrices.
    </p>

    <definition xml:id="def-change-of-basis-matrix">
      <statement>
        <p>
          Let <m>\basis{B} = \left\{ \ve{b}_1, \ldots, \ve{b}_n \right\}</m> and
          <m>\basis{C} = \left\{ \ve{c}_1, \ldots, \ve{c}_n \right\}</m>
          be bases for a vector space <m>V</m>.
          The <term>change-of-basis matrix from
          <m>\basis{B}</m> to <m>\basis{C}</m></term>
          is the <m>n \times n</m> matrix <m>\mat{P}_{\basis{C} \leftarrow \basis{B}}</m> whose columns are the coordinate vectors
          <m>[\ve{b}_1]_\basis{C}, \ldots, [\ve{b}_n]_\basis{C}</m>:
          <me>
            \mat{P}_{\basis{C} \leftarrow \basis{B}} := \begin{bmatrix} \left[\begin{array}{c} \, \\ \ve{b}_1 \\ \, \end{array}\right]_\basis{C} \amp \left[\begin{array}{c} \,\\ \ve{b}_2 \\ \, \end{array}\right]_\basis{C} \amp \ldots \amp \left[\begin{array}{c} \, \\ \ve{b}_n \\ \,\end{array}\right]_\basis{C}  \end{bmatrix}\,
          </me>.
        </p>
      </statement>
    </definition>

    <example>
      <statement>
        <p>
          In our running example, we see from
          <xref ref="b_in_terms_of_c" /> and <xref ref="b_in_terms_of_c_2" /> that
          <me>
            [\ve{b}_1]_\basis{C} = \begin{bmatrix} 1 \\ 3 \end{bmatrix}, \quad [\ve{b}_2]_\basis{C} = \begin{bmatrix} 2 \\ 3 \end{bmatrix} \,
          </me>.
        </p>

        <p>
          Hence the change-of-basis matrix from
          <m>\basis{B}</m> to <m>\basis{C}</m> is
          <me>
            \mat{P}_{\basis{C} \leftarrow \basis{B}} = \begin{bmatrix} 1 \amp 2 \\ 3 \amp 3  \end{bmatrix}
          </me>.
        </p>
      </statement>
    </example>

    <p>
      Before we move on, we need to recall something about matrix multiplication.
      Suppose you collect together <m>m</m> column vectors to form a matrix:
      <me>
        \begin{bmatrix} \left[\begin{array}{c} \, \\ \text{C}_1 \\ \, \end{array}\right] \amp \left[\begin{array}{c} \,\\ \text{C}_2 \\ \, \end{array}\right] \amp \ldots \amp \left[\begin{array}{c} \, \\ \text{C}_m \\ \,\end{array}\right]  \end{bmatrix}
      </me>
    </p>

    <p>
      (For instance, our change-of-basis matrix
      <m>\mat{P}_{\basis{C} \leftarrow \basis{B}}</m> was formed in this way.) Then the product of this matrix with a column vector can be computed as follows:
      <men xml:id="column_vector_multiplication">
        \begin{bmatrix} \left[\begin{array}{c} \, \\ \text{C}_1 \\ \, \end{array}\right] \amp \left[\begin{array}{c} \,\\ \text{C}_2 \\ \, \end{array}\right] \amp \ldots \amp \left[\begin{array}{c} \, \\ \text{C}_m \\ \,\end{array}\right]  \end{bmatrix}\left[\begin{array}{c} a_1 \\ a_2 \\ \vdots \\ a_m \end{array}\right] = a_1 \left[\begin{array}{c} \,  \\ \text{C}_1 \\ \, \end{array}\right] + a_2 \left[\begin{array}{c} \,  \\ \text{C}_2 \\ \, \end{array}\right] + \cdots + a_m \left[\begin{array}{c} \,  \\ \text{C}_m \\ \, \end{array}\right]
      </men>.
    </p>

    <exercise>
      <statement>
        <p>
          Prove the above formula!
        </p>
      </statement>
      <solution>
        <p>
          We check the <m>i^\text{th}</m> entry of the left hand-side of <xref ref="column_vector_multiplication"/> using just the definition of matrix multiplation.
          <me>
            (\text{LHS})_i = (\text C_1)_ia_1 + \ldots + (\text C_n)_ia_n = (\text{RHS})_i
          </me>
          and we're done!
        </p>
      </solution>
    </exercise>

    <p>
      We can now prove the following theorem.
    </p>

    <theorem xml:id="change-of-basis-thm">
      <title>Change of basis</title>
      <statement>
        <p>
          Suppose that <m>\basis{B} = \left\{ \ve{b}_1, \ldots, \ve{b}_n\right\}</m> and
          <m>\basis{C} = \left\{ \ve{c}_1, \ldots, \ve{c}_n \right\}</m> are bases for a vector space <m>V</m>,
          and let <m>\mat{P}_{\basis{C} \leftarrow \basis{B}}</m> be the
          change-of-basis matrix from <m>\basis{B}</m> to <m>\basis{C}</m>.
          Then for all vectors <m>\ve{v}</m> in <m>V</m> we have
          <men xml:id="change-of-basis-in-action">
            [\ve{v}]_\basis{C} = \mat{P}_{\basis{C} \leftarrow \basis{B}} [\ve{v}]_\basis{B}
          </men>.
        </p>
      </statement>
      <proof>
        <p>
          Let <m>\ve{v} \in V</m>.
          Expand it in the basis <m>\basis{B}</m>:
          <me>
            \ve{v} = a_1 \ve{b}_1 + a_2 \ve{b}_2 + \cdots + a_n \ve{b}_n,  \text{i.e. }  [\ve{v}]_\basis{B} = \begin{bmatrix} a_1 \\ \vdots \\ a_n \end{bmatrix}
          </me>.
        </p>

        <p>
          Then,
          <md>
            <mrow>[\ve{v}]_\basis{C} \amp = [a_1 \ve{b}_1 + \cdots + a_n \ve{b}_n]_\basis{C}</mrow>
            <mrow>\amp = a_1 [\ve{b}_1]_\basis{C} + \cdots + a_n [\ve{b}_n]_\basis{C}  \amp \amp  (<xref ref="lin_of_coord_vectors">Lemma</xref>)</mrow>
            <mrow>\amp =   \begin{bmatrix} \left[\begin{array}{c} \, \\ \ve{b}_1 \\ \, \end{array}\right] \amp \left[\begin{array}{c} \,\\ \ve{b}_2 \\ \, \end{array}\right] \amp \ldots \amp \left[\begin{array}{c} \, \\ \ve{b}_n \\ \,\end{array}\right]  \end{bmatrix}\left[\begin{array}{c} a_1 \\ \vdots \\ a_n \end{array}\right] \amp \amp <xref ref = "column_vector_multiplication"/></mrow>
            <mrow>\amp =    \mat{P}_{\basis{C} \leftarrow \basis{B}} [\ve{v}]_\basis{B} \, </mrow>
          </md>.
        </p>
      </proof>
    </theorem>

    <example>
      <statement>
        <p>
          In our running example, the theorem says that for <em>any</em>
          vector <m>\ve{v} \in \mathbb{R}^2</m>,
          <me>
            [\ve{v}]_\basis{C} = \begin{bmatrix} 1 \amp  2 \\ 3 \amp  3  \end{bmatrix} [\ve{v}]_\basis{B}  .
          </me>
        </p>

        <p>
          In particular, this must hold for our vector <m>\ve{w}</m>,
          whose coordinate vector in the basis <m>\ve{B}</m> was:
          <me>
            [\ve{w}]_\basis{B} = \begin{bmatrix} -3 \\ 2 \end{bmatrix}
          </me>.
        </p>

        <p>
          So in this case, the theorem is saying that
          <me>
            [\ve{w}]_{\basis{C}} = \begin{bmatrix} 1 \amp  2 \\ 3 \amp  3 \end{bmatrix} \begin{bmatrix} -3 \\ 2\end{bmatrix} = \begin{bmatrix} 1 \\ -3 \end{bmatrix}
          </me>
          which agrees with our previous calculation <xref ref="w_in_basis_C" />!
        </p>
      </statement>
    </example>
  </subsection>

  <exercises>
    <exercise>
    <statement>
      <p>
        This is a continuation of <xref ref="matrix_basis_exercise">Exercise</xref>.
        Consider the following two bases for <m>\Mat_{2,2}</m>:
        <me>
          \basis B = \left\{
          \text{B}_1 =   \begin{bmatrix} 1 \amp  0 \\ 0 \amp  1 \end{bmatrix}, \,
          \text{B}_2 =   \begin{bmatrix} 1 \amp  0\\ 0 \amp  -1 \end{bmatrix}, \,
          \text{B}_3 =   \begin{bmatrix} 1 \amp  1 \\ 1 \amp  1 \end{bmatrix}, \,
          \text{B}_4 =   \begin{bmatrix} 0 \amp  1 \\ -1 \amp 0 \end{bmatrix}
          \right\}
        </me>

        <me>
          \basis C = \left\{
          \text{C}_1 =   \begin{bmatrix} 1 \amp  1 \\ 0 \amp  0  \end{bmatrix}, \,
          \text{C}_2 =   \begin{bmatrix} 1 \amp  -1 \\ 0 \amp  0 \end{bmatrix}, \,
          \text{C}_3 =   \begin{bmatrix} 0 \amp  0 \\ 1 \amp  1 \end{bmatrix}, \,
          \text{C}_4 =   \begin{bmatrix} 0 \amp  0 \\ 1 \amp -1 \end{bmatrix}
          \right\}
        </me>

        <ol label="(a)">
          <li>
            <p>
              Determine the change-of-basis matrices
              <m>\mat{P}_{\basis{C} \leftarrow \basis{B}}</m> and <m>\mat{P}_{\basis{B} \leftarrow \basis{C}}</m>.
            </p>
          </li>

          <li>
            <p>
              Determine <m>[\mat{A}]_\basis{B}</m> and <m>[\mat{A}]_\basis{C}</m> where
              <me>
                A = \begin{bmatrix} 1 \amp 2 \\ 3 \amp 4 \end{bmatrix}
              </me>.
            </p>
          </li>

          <li>
            <p>
              Check that <m>[\mat{A}]_\basis{C} = \mat{P}_{\basis{C} \leftarrow \basis{B}} [\mat{A}]_\basis{B}</m>
              and that <m>[\mat{A}]_\basis{B} = \mat{P}_{\basis{B} \leftarrow \basis{C}} [\mat{A}]_\basis{C}</m>.
            </p>
          </li>
        </ol>
      </p>
    </statement>
    <answer>
        <p>
          <me> \mat{P}_{\basis C\leftarrow \basis B } = \begin{bmatrix}
            1/2 \amp 1/2\amp 1\amp 1/2\\
            1/2 \amp 1/2\amp 0\amp -1/2\\
            1/2 \amp -1/2\amp 1\amp -1/2\\
            -1/2\amp 1/2\amp 0\amp -1/2
          \end{bmatrix}
          </me>
          <me> \mat{P}_{\basis B\leftarrow \basis C} = \begin{bmatrix}
            0   \amp 1    \amp 0    \amp -1  \\
            1/2 \amp 1/2  \amp -1/2 \amp 1/2 \\
            1/2 \amp -1/2 \amp 1/2  \amp 1/2 \\
            1/2 \amp -1/2 \amp -1/2 \amp -1/2
          \end{bmatrix}
          </me>
          <me>
            [\mat{A}]_{\basis B} = \begin{bmatrix} 3/2 \\ -1/2 \\ 7/2 \\ -1/2 \end{bmatrix}
          </me>
          <me>
            [\mat{A}]_{\basis C} = \begin{bmatrix} 0 \\ -3/2  \\ 5/2 \\ -1/2 \end{bmatrix}
          </me>
        </p>
      </answer>
      <solution>
        <p>
          The matrix <m>\mat{P}_{\basis C\leftarrow \basis B}</m> is defined to have the columns
          <me> [\mat{B}_1]_{\basis C}, [\mat{B}_2]_{\basis C}, [\mat{B}_3]_{\basis C}, [\mat{B}_4]_{\basis C}</me>.
          For example, to compute <m>[\mat{B}_1]_{\basis C}</m>, we set
          <me> [\mat{B}_1]_{\basis C} = \begin{bmatrix} a\\b\\c\\d \end{bmatrix}</me>
          and solve for <m>a,b,c,d</m>.
          That equations is equivalent to
          <me> \mat{B}_1 = a\mat{C}_1+b\mat{C}_2+c\mat{C}_3+d\mat{C}_4</me>.
          If we now set each of the four entries of the left hand-side equal to the corresponding entry on the right hand-side, we get the system
          <md>
            <mrow>1 \amp = a+b</mrow>
            <mrow>0 \amp = a-b</mrow>
            <mrow>0 \amp = c+d</mrow>
            <mrow>1 \amp = c-d</mrow>
          </md>.
          It has the solution
          <md> <mrow> a=b=c=1/2\amp\amp d=-1/2</mrow></md>
          and thus
          <me> [\mat{B}_1]_{\basis C} = \begin{bmatrix} 1/2 \\1/2 \\1/2 \\ -1/2 \end{bmatrix}</me>.
        </p>
        <p>
          Similarly, if we want to compute <m>[\mat{B}_2]_{\basis C}</m>, we nee dto solve the system
          <md>
            <mrow>1 \amp = a+b</mrow>
            <mrow>0 \amp = a-b</mrow>
            <mrow>0 \amp = c+d</mrow>
            <mrow>-1 \amp = c-d</mrow>
          </md>.
          It has the solution
          <md> <mrow> a=b=d=1/2\amp\amp c=-1/2</mrow></md>
          and thus
          <me> [\mat{B}_1]_{\basis C} = \begin{bmatrix} 1/2 \\1/2 \\-1/2 \\ 1/2 \end{bmatrix}</me>.
        </p>
        <p>
          In the same way, we get
          <me> [\mat{B}_3]_{\basis C} = \begin{bmatrix} 1 \\0 \\1 \\ 0 \end{bmatrix}\quad\text{and}\quad [\mat{B}_1]_{\basis C} = \begin{bmatrix} 1/2 \\-1/2 \\-1/2 \\ -1/2 \end{bmatrix}</me>.
          If we put it all together, we get
          <me> \mat{P}_{\basis C\leftarrow \basis B} = \begin{bmatrix}
            1/2 \amp 1/2\amp 1\amp 1/2\\
            1/2 \amp 1/2\amp 0\amp -1/2\\
            1/2 \amp -1/2\amp 1\amp -1/2\\
            -1/2\amp 1/2\amp 0\amp -1/2
          \end{bmatrix}</me>
        </p>
        <p>
          To compute <m>\mat{P}_{\basis B\leftarrow \basis C}</m>, we need to compute the coordinate vector of each of the matrices <m>\mat{C}_1,\ldots, \mat{C}_4</m> with respect to <m>\basis B</m>.
          That follows the same procedure as above, except that the systems will be different.
          The result is
          <me> \mat{P}_{\basis B\leftarrow \basis C} = \begin{bmatrix}
            0   \amp 1    \amp 0    \amp -1  \\
            1/2 \amp 1/2  \amp -1/2 \amp 1/2 \\
            1/2 \amp -1/2 \amp 1/2  \amp 1/2 \\
            1/2 \amp -1/2 \amp -1/2 \amp -1/2
          \end{bmatrix}
          </me>.
        </p>
      </solution>
  </exercise>

  <exercise>
    <statement>
      <p>
        Given the two bases <m>\basis{B}</m> and <m>\basis{B}'</m>,
        find the change of basis matrix <m>\mat{P}_{\basis{B'}\leftarrow \basis{B}}</m>.
      <ol label="(a)">
        <li>
          <m>V = \Row_2</m>, <m>\basis{B} = ((1,3),(3,8))</m> and <m>\basis{B}' = ((2,-1), (-3,2)) </m>;
        </li>
        <li>
          <m>V = \Row_2</m>, <m>\basis{B} = ((2,-1), (-3,2)) </m> and <m>\basis{B}' =  ((1,3),(3,8))</m>;
        </li>
        <li>
          <m>V = \Poly_2</m>, <m>\basis{B} = (x, 2x^2-x+3, x^2+2x+2)</m>  and <m>\basis{B}' = (1+5x^2,x^2,3-x-2x^2) </m>.
        </li>
      </ol>
      </p>
    </statement>
    <answer>
      <p>
        <ol label="a">
          <li>
            <me> \mat{P}_{\basis B'\leftarrow \basis B} = \begin{bmatrix} 11\amp 30 \\ 7\amp 19\end{bmatrix} </me>
          </li>
          <li>
            <me> \mat{P}_{\basis B'\leftarrow \basis B} = \begin{bmatrix} -19 \amp 35 \\ 7 \amp -11 \end{bmatrix}</me>
          </li>
          <li>
            <me> \mat{P}_{\basis B'\leftarrow\basis B} = \begin{bmatrix} 3\amp 0\amp 8 \\ -17\amp 4\amp -43 \\ -1\amp 1\amp -2\end{bmatrix}</me>
          </li>
        </ol>
      </p>
    </answer>
    <solution>
      <p>
        <ol label="a">
          <li>
            We need to find the coordinate vectors of <m>(1,3)</m> and <m>(3,8)</m> with respect to <m>\basis B'</m>.
            Set
            <me> [(1,3)]_{\basis B'} = \begin{bmatrix} a\\b \end{bmatrix}</me>.
            This means that
            <me> (1,3) = a(2,-1) + b(-3,2)</me>
            which leads to the system
            <md>
              <mrow> 1\amp = 2a - 3b</mrow>
              <mrow> 3\amp = -a+2b</mrow>
            </md>
            with the solution <m>a=11</m>, <m>b=7</m>. Similarly, we now set
            <me>[(3,8)]_{\basis B'} = \begin{bmatrix} a\\b \end{bmatrix}</me>
            which leads to the system
            <md>
              <mrow> 3\amp = 2a - 3b</mrow>
              <mrow> 8\amp = -a+2b</mrow>
            </md>
            and the solution <m>a=30</m>, <m>b=19</m>. Thus
            <me> \mat{P}_{\basis B'\leftarrow \basis B} = \begin{bmatrix} 11\amp 30 \\ 7\amp 19\end{bmatrix} </me>.
          </li>
          <li>
            Similar to (a), we will write the vectors <m>(2,-1)</m> and <m>(-3,2)</m> as linear combinations of the basis elements <m>(1,3)</m>, <m>(3,8)</m> of <m>\basis B'</m>. First set
            <me>[(2,-1)]_{\basis B'} = \begin{bmatrix} a\\b \end{bmatrix}</me>,
            in other words
            <md>
              <mrow>2\amp = a+3b</mrow>
              <mrow>-1\amp = 3a+8b</mrow>
            </md>
            which has the solution <m>a=-19</m>, <m>b=7</m>. Thus
            <me> [(2,-1)] = \begin{bmatrix} -19 \\ 7 \end{bmatrix}</me>.
            Similarly, we find that
            <me>[(-3,2)] = \begin{bmatrix} 35 \\ -11 \end{bmatrix}</me>.
            Thus
            <me> \mat{P}_{\basis B'\leftarrow \basis B} = \begin{bmatrix} -19 \amp 35 \\ 7 \amp -11 \end{bmatrix}</me>.
          </li>
          <li>
            We need to write each of <m>x</m>, <m>2x^2-x+3</m> and <m>x^2+2x+2</m> as a linear combination of the form
            <me> a(1+5x^2)+b(x^2)+c(3-x-2x^2)</me>.
            For <m>x</m> that leads to the system
            <md>
              <mrow>0 \amp = a+3c</mrow>
              <mrow>1 \amp = -c</mrow>
              <mrow>0 \amp = 5a+b-2c</mrow>
            </md>
            with solution <m>a=3</m>, <m>b=-17</m>, <m>c=-1</m>.
            For <m>2x^2-x+3</m> this leads to the system
            <md>
              <mrow>3 \amp = a+3c</mrow>
              <mrow>-1 \amp = -c</mrow>
              <mrow>2 \amp = 5a+b-2c</mrow>
            </md>
            with the solution <m>a=0</m>, <m>b=4</m>, <m>c=1</m>.
            For <m>x^2+2x+2</m> this leads to the system
            <md>
              <mrow>2 \amp = a+3c</mrow>
              <mrow>2 \amp = -c</mrow>
              <mrow>1 \amp = 5a+b-2c</mrow>
            </md>
            with the solution <m>a=8</m>, <m>b=-43</m>, <m>c=-2</m>.
            Thus
            <me> \mat{P}_{\basis B'\leftarrow\basis B} = \begin{bmatrix} 3\amp 0\amp 8 \\ -17\amp 4\amp -43 \\ -1\amp 1\amp -2\end{bmatrix}</me>.
          </li>
        </ol>
      </p>
    </solution>
  </exercise>

  <exercise>
    <statement>
      <p>
        Compute the change-of-basis matrix
        <m>\mat{P}_{\basis{B} \leftarrow \basis{S}}</m> from the standard basis
        <me>
          \basis{S} = \left\{ 1, \cos x, \sin x, \cos 2x, \sin 2x \right\}
        </me>
        of <m>\Trig_2</m> to the basis
        <me>
          \basis{B} = \left\{ 1, \cos x, \sin x, \cos^2 x, \sin x\cos x \right\} \,
        </me>.
      </p>
    </statement>
    <hint>
      <p>
        <m>\cos (2x) = 2\cos^2 x -1</m> and <m>\sin (2x) = 2\sin x\cos x</m>.
      </p>
    </hint>
    <answer>
      <p>
        <me>\mat{P}_{\basis{B} \leftarrow \basis{S}} =
        \begin{bmatrix}
          1 \amp 0 \amp 0 \amp -1 \amp 0\\
          0 \amp 1 \amp 0 \amp 0 \amp  0\\
          0 \amp 0 \amp 1 \amp 0 \amp  0\\
          0 \amp 0 \amp 0 \amp 2 \amp  0\\
          0 \amp 0 \amp 0 \amp 0 \amp  2
        \end{bmatrix}
        </me>
      </p>
    </answer>
  </exercise>

  <exercise>
    <statement>
      <p>
        <xref ref="w_in_b_basis_exc"/> displays a basis <m>\basis{B} = \bopen \ve{b}_1, \ve{b}_2 \bclose</m> for <m>\mathbb{R}^2</m>, a background of integral linear combinations of <m>\ve{b}_1</m> and <m>\ve{b}_2</m>, and a certain vector <m>\ve{w} \in \mathbb{R}^2</m>. Similarly, <xref ref="w_in_c_basis_exc"/> displays another basis <m>\basis{C} = \bopen \ve{c}_1, \ve{c}_2 \bclose</m> for <m>\mathbb{R}^2</m>, a background of integral linear combinations of <m>\ve{c}_1</m> and <m>\ve{c}_2</m>, and the same vector <m>\ve{w} \in \mathbb{R}^2</m>.
      </p>
      <sidebyside>
        <figure xml:id="w_in_b_basis_exc">
          <caption>
            The vector <m>\ve{w}</m> against a background of integral linear combinations of the basis vectors from <m>\basis{B}</m>.
          </caption>
          <image>
            <latex-image>
              <![CDATA[\begin{tikzpicture}[scale=0.5]
              \clip (-5,-5) rectangle (5,5);
              \draw[primaryColor, dotted] (-3, -9) -- (9, -3);
              \draw[primaryColor, dotted] (-4, -7) -- (8, -1);
              \draw[primaryColor, dotted] (-5, -5) -- (7, 1);
              \draw[primaryColor, dotted] (-6, -3) -- (6, 3);
              \draw[primaryColor, dotted] (-7, -1) -- (5, 5);
              \draw[primaryColor, dotted] (-8, 1) -- (4, 7);
              \draw[primaryColor, dotted] (-9, 3) -- (3, 9);

              \draw[primaryColor, dotted] (-3, -9) -- (-9, 3);
              \draw[primaryColor, dotted] (-1, -8) -- (-7, 4);
              \draw[primaryColor, dotted] (1, -7) -- (-5, 5);
              \draw[primaryColor, dotted] (3, -6) -- (-3, 6);
              \draw[primaryColor, dotted] (5, -5) -- (-1, 7);
              \draw[primaryColor, dotted] (7, -4) -- (1, 8);
              \draw[primaryColor, dotted] (9, -3) -- (3, 9);

              \draw[very thick, primaryColor, ->] (0,0) -- node[pos=1.3] {\(\ve{b}_1\)} (2,1);
              \draw[very thick, primaryColor, ->] (0,0) -- node[pos=1.3] {\(\ve{b}_2\)} (-1,2);
              \draw[thick, ->] (0,0) -- node[pos=1.2] {\(\ve{w}\)} (3,-1);\end{tikzpicture}]]>
            </latex-image>
          </image>
        </figure>

        <figure xml:id="w_in_c_basis_exc">
          <caption>The vector <m>\ve{w}</m> against a background of integral linear combinations of the basis vectors from <m>\basis{C}</m>. </caption>
          <image>
            <latex-image>
              <![CDATA[\begin{tikzpicture}[scale=0.5]
              \clip (-5,-5) rectangle (5,5);
              \draw[secondaryColor, dotted] (0, -6) -- (6, 0);
              \draw[secondaryColor, dotted] (-1, -5) -- (5, 1);
              \draw[secondaryColor, dotted] (-2, -4) -- (4, 2);
              \draw[secondaryColor, dotted] (-3, -3) -- (3, 3);
              \draw[secondaryColor, dotted] (-4, -2) -- (2, 4);
              \draw[secondaryColor, dotted] (-5, -1) -- (1, 5);
              \draw[secondaryColor, dotted] (-6, 0) -- (0, 6);

              \draw[secondaryColor, dotted] (0, -6) -- (-6, 0);
              \draw[secondaryColor, dotted] (1, -5) -- (-5, 1);
              \draw[secondaryColor, dotted] (2, -4) -- (-4, 2);
              \draw[secondaryColor, dotted] (3, -3) -- (-3, 3);
              \draw[secondaryColor, dotted] (4, -2) -- (-2, 4);
              \draw[secondaryColor, dotted] (5, -1) -- (-1, 5);
              \draw[secondaryColor, dotted] (6, 0) -- (0, 6);

              \draw[very thick, secondaryColor, ->] (0,0) -- node[pos=1.6] {\(\ve{c}_1\)} (1,1);
              \draw[very thick, secondaryColor, ->] (0,0) -- node[pos=1.6] {\(\ve{c}_2\)} (-1,1);
              \draw[thick, ->] (0,0) -- node[pos=1.2] {\(\ve{w}\)} (3,-1);\end{tikzpicture}]]>
            </latex-image>
          </image>
        </figure>
      </sidebyside>

    <ol label="(a)">
      <li xml:id="ch-basis-exercise2">
        <p> Determine <m>[\ve{w}]_\basis{B}</m>, directly from <xref ref="w_in_b_basis_exc"/>. </p>
      </li>
      <li xml:id="ch-basis-exercise3">
        <p> Determine <m>[\ve{w}]_\basis{C}</m>, directly from <xref ref="w_in_c_basis_exc"/>. </p>
      </li>
      <li xml:id="ch-basis-exercise1"> <p>The following figure displays the basis <m>\basis{B}</m>  against a background of integral linear combinations of the basis <m>\basis{C}</m>:</p>

        <image width="50%">
          <latex-image>
            <![CDATA[\begin{tikzpicture}[scale=0.5]
            \clip (-5,-5) rectangle (5,5);
            \draw[secondaryColor, dotted] (0, -6) -- (6, 0);
            \draw[secondaryColor, dotted] (-1, -5) -- (5, 1);
            \draw[secondaryColor, dotted] (-2, -4) -- (4, 2);
            \draw[secondaryColor, dotted] (-3, -3) -- (3, 3);
            \draw[secondaryColor, dotted] (-4, -2) -- (2, 4);
            \draw[secondaryColor, dotted] (-5, -1) -- (1, 5);
            \draw[secondaryColor, dotted] (-6, 0) -- (0, 6);

            \draw[secondaryColor, dotted] (0, -6) -- (-6, 0);
            \draw[secondaryColor, dotted] (1, -5) -- (-5, 1);
            \draw[secondaryColor, dotted] (2, -4) -- (-4, 2);
            \draw[secondaryColor, dotted] (3, -3) -- (-3, 3);
            \draw[secondaryColor, dotted] (4, -2) -- (-2, 4);
            \draw[secondaryColor, dotted] (5, -1) -- (-1, 5);
            \draw[secondaryColor, dotted] (6, 0) -- (0, 6);

            \draw[very thick, secondaryColor, ->] (0,0) -- node[pos=1.6] {\(\ve{c}_1\)} (1,1);
            \draw[very thick, secondaryColor, ->] (0,0) -- node[pos=1.6] {\(\ve{c}_2\)} (-1,1);
            \draw[very thick, primaryColor, ->] (0,0) -- node[pos=1.3] {\(\ve{b}_1\)} (2,1);
            \draw[very thick, primaryColor, ->] (0,0) -- node[pos=1.3] {\(\ve{b}_2\)} (-1,2);\end{tikzpicture}]]>
          </latex-image>
        </image>
        <p>
          Determine the change-of-basis matrix <m>\mat{P}_{\basis{C} \leftarrow \basis{B}}</m>. (You may assume that all coefficients are either integers and half-integers (like <m>3/2</m>).)
        </p>
      </li>
      <li> <p>
        Multiply the matrix you computed in <xref ref="ch-basis-exercise1" >(c)</xref> with the column vector you computed in <xref ref="ch-basis-exercise2" >(a)</xref>. That is, compute the product <m>\mat{P}_{\basis{C} \leftarrow \basis{B}} [\mat{w}]_{\basis{B}}</m>. Is your answer the same as what you obtained in <xref ref="ch-basis-exercise3" >(b)</xref>?
      </p></li>
    </ol>
    </statement>
    <hint>
      <p>
        Write <m>\ve w</m> as linear combinations of the vectors <m>\ve b_1, \ve b_2</m> (for (a)) and of <m>\ve c_1,\ve c_2</m> (for (b).
        Then write the vectors <m>\ve b_1,\ve b_2</m> as linear combinations of <m>\ve c_1,\ve c_2</m> (for (c)).
      </p>
    </hint>
    <answer>
      <p>
        <ol label="a" cols="3">
          <li>
            <m>[\ve w]_{\basis B} = \cvector{1\\-1}</m>
          </li>
          <li>
            <m>[\ve w]_{\basis B} = \cvector{1\\-2}</m>
          </li>
          <li>
            <m>\mat{P}_{\basis C\leftarrow \basis B} =
              \begin{bmatrix} 1.5 \amp 0.5\\ -0.5 \amp 1.5 \end{bmatrix}
            </m>
          </li>
        </ol>
      </p>
    </answer>
  </exercise>

  <exercise>
    <statement>
      <p>
        In the following problems, you are given some coordinate vectors and change of basis matrices and asked to find other coordinate vectors:
      <ol label="(a)">
        <li>
          Let <m>V=\Row_2</m>,
          <m>\mat{P}_{\basis{B}'\leftarrow \basis{B}} = \begin{bmatrix} 3\amp 2\\1\amp 2\end{bmatrix}</m> and
          <m>[\ve v]_{\basis{B}}=\begin{bmatrix}1\\-2 \end{bmatrix}</m>.
          Find <m>[\ve v]_{\basis{B}'}</m>.
        </li>
        <li>
          Let <m>V=\Row_3</m>,
          <m>P_{\basis{B}'\leftarrow \basis{B}} = \begin{bmatrix} 3\amp 2\amp 1\\1\amp 2\amp 2\\2\amp 0\amp 1\end{bmatrix}</m> and
          <m>[\ve v]_{\basis{B}}=\begin{bmatrix}1\\-2\\-1 \end{bmatrix}</m>.
          Find <m>[\ve v]_{\basis{B}'}</m>.
        </li>
        <li>
          Let <m>V=\Row_2</m>,
          <m>\mat{P}_{\basis{B}'\leftarrow \basis{B}} = \begin{bmatrix} 2 \amp 2\\1\amp 2\end{bmatrix}</m>
          and <m>[\ve v]_{\basis{B}'}=\begin{bmatrix}1\\-2 \end{bmatrix}</m>.
          Find <m>[\ve v]_{\basis{B}}</m>.
        </li>
      </ol>
      </p>
    </statement>
    <answer>
      <p>
        <ol label="a" cols="3">
          <li> <m>\begin{bmatrix}-1 \\ -3\end{bmatrix}</m></li>
          <li><m>\begin{bmatrix}-2 \\ -5 \\ 1\end{bmatrix}</m></li>
          <li><m>\begin{bmatrix} 3\\ -5/2\end{bmatrix}</m></li>
        </ol>
      </p>
    </answer>
    <solution>
      <p>
        <ol label="a">
          <li>
            By <xref ref="change-of-basis-thm" /> we have
            <md>
              <mrow>
              [\ve v]_{\basis B'} \amp = \mat{P}_{\basis B'\leftarrow \basis B}[\ve v]_{\basis B}</mrow>
              <mrow>
              \amp = \begin{bmatrix} 3\amp 2\\1\amp 2\end{bmatrix}\begin{bmatrix}1\\-2 \end{bmatrix}
              = \begin{bmatrix}-1 \\ -3\end{bmatrix} </mrow>
            </md>
          </li>
          <li>
            Again, by <xref ref="change-of-basis-thm" /> we have
            <md>
              <mrow>
              [\ve v]_{\basis B'} \amp = \mat{P}_{\basis B'\leftarrow \basis B}[\ve v]_{\basis B}</mrow>
              <mrow>
              \amp = \begin{bmatrix} 3\amp 2\amp 1\\1\amp 2\amp 2\\2\amp 0\amp 1\end{bmatrix}\begin{bmatrix}1\\-2\\-1  \end{bmatrix}
              = \begin{bmatrix}-2 \\ -5 \\ 1\end{bmatrix} </mrow>
            </md>
          </li>
          <li>
            This time we need to be a little more careful. We will apply <xref ref="change-of-basis-thm" /> again, but this time it gives
            <me> \begin{bmatrix}1\\-2 \end{bmatrix} =  \begin{bmatrix} 2 \amp 2\\1\amp 2\end{bmatrix} [\ve v]_{\basis B}</me>.
            So, we cannot just do a matrix multiplication.
            We first need to find the inverse of
            <me>\mat{P}_{\basis B'\leftarrow \basis B} = \begin{bmatrix} 2 \amp 2\\1\amp 2\end{bmatrix}</me>.
            The inverse is
            <me> \frac{1}{2}\begin{bmatrix} 2\amp -2\\ -1\amp 2\end{bmatrix} = \begin{bmatrix} 1\amp -1\\ -1/2 \amp 1\end{bmatrix}</me>
            and thus
            <me> [\ve v]_{\basis B} = \begin{bmatrix} 1\amp -1\\ -1/2 \amp 1\end{bmatrix}\begin{bmatrix}1\\-2 \end{bmatrix} = \begin{bmatrix} 3\\ -5/2\end{bmatrix}</me>.
            <em>Follow-up question</em>: Will this method always work? In other words, is the matrix <m>\mat{P}_{\basis B'\leftarrow\basis B}</m> always invertible?
          </li>
        </ol>
      </p>
    </solution>
  </exercise>

<exercise>
  <statement>
    <p>
      Consider the following three bases for <m>\mathbb R^3</m>:
      <md>
        <mrow>  \mathcal A = \bopen (1,0,0), (0,1,0), (0,0,1) \bclose </mrow>
        <mrow> \mathcal B = \bopen (2,1,1) , (1,1,1), (0,2,1) \bclose </mrow>
        <mrow> \mathcal C= \bopen (1,2,3),(0,1,0),(1,0,1) \bclose</mrow>
      </md>.
      Compute <m>\mat{P}_{\basis{A} \leftarrow \basis{B}}, \mat{P}_{\basis{A} \leftarrow \basis{C}}, \mat{P}_{\basis{B} \leftarrow \basis{C}}</m> and verify the equation
      <me>
        \mat{P}_{\basis{A} \leftarrow \basis{B}}  \mat{P}_{\basis{B} \leftarrow \basis{C}} =  \mat{P}_{\basis{A} \leftarrow \basis{C}}.
      </me>
    </p>
  </statement>
  <!-- TO BE TRANSLATED AND COMPLETED!!
  <solution>
    <p>
      Die twee matrikse <m>\mat{P}_{\basis{A} \leftarrow \basis{B}}</m> en <m>\mat{P}_{\basis{A} \leftarrow \basis{C}}</m> is maklik om neer te skryf omdat 'n mens onmiddellik die elemente van <m>\basis B</m> en <m>\basis C</m> kan skryf as lineêre kombinasies van die elemente van <m>\basis A</m>:
      <me> \mat{P}_{\basis{A} \leftarrow \basis{B}} =
      \begin{bmatrix}
        2\amp 1\amp 0 \\
        1\amp 1\amp 2 \\
        1\amp 1\ampm 1
      \end{bmatrix}\qquad \mat{P}_{\basis{A} \leftarrow \basis{C}} =
      \begin{bmatrix}
        1\amp 0\amp 1\\
        2\amp 1\amp 0\\
        3\amp 0\amp 1
      \end{bmatrix}
      </me>
    </p>
  </solution> -->
</exercise>

  <exercise>
    <statement>
      <p>
        The purpose of this exercise is to be a <q>mixed practice</q> problem.
        Try to do them without looking back to previous problems to see how well you can do them <q>out of context</q>.
        This requires a more flexible understanding of the connections between concepts.
      <ol label="(a)">
      <li>
        Let <m>V=\Poly_2</m> and <m>\basis{B} = (1+x-x^2, 2x^2-1, 2-3x)</m> and
        <m>\mat{P}_{\basis{B}'\leftarrow \basis{B}} = \begin{bmatrix} 1\amp 1\amp -1\\ 2\amp -1\amp 0\\ 0\amp 1\amp 1\end{bmatrix}</m>.
        Calculate the basis <m>\basis{B}'</m>.
      </li>
      <li>
        Suppose that <m>\mat{P}_{\basis{B}\leftarrow \basis{B}'}=\begin{bmatrix} 1\amp 1\\2\amp 1\end{bmatrix}</m>
        and <m>\mat{P}_{\basis{B}\leftarrow \basis{B}''}=\begin{bmatrix} 3\amp 2\\1\amp 1\end{bmatrix}</m>
        and <m>[v]_{\basis{B}'}=\begin{bmatrix} 1\\-1\end{bmatrix}</m>.
        Find <m>[v]_{\basis{B}''}</m>.
      </li>
      <li>
        Let <m>V=\Row_2</m>, and
        <m>\basis{B}=((-1,1),(3,-2))</m>, and
        <m>\mat{P}_{\basis{B}'\leftarrow \basis{B}}=\begin{bmatrix} 1\amp 3\\2\amp -2\end{bmatrix}</m>
        and <m>[v]_{\mathcal{B}'}=\begin{bmatrix} -1\\2 \end{bmatrix}</m>.
        Calculate the vector <m>v</m>.
      </li>
      </ol>
      </p>
    </statement>
  </exercise>

  <exercise>
    <statement>
      <p>
        Prove that if <m>\basis{B}</m> is a basis for the <m>n</m>-dimensional vector space <m>V</m>, then <m>\mat{P}_{\basis{B}\leftarrow\basis{B}}</m> is the <m>n\times n</m> identity matrix.
      </p>
    </statement>
  </exercise>

  <exercise>
    <statement>
      <p>
        Let us assume  that <m>\basis{B}</m> and
        <m>\basis{B}'</m> are two bases for the
        finite-dimensional vector space <m>V</m>.
        Suppose that <m>\basis{B}</m> consists of the
        vectors <m>b_1,\ldots, b_n</m> in order.
        Prove that the vectors
        <me>
          [b_1]_{\basis{B}'},\ldots, [b_n]_{\basis{B}'}
        </me>
        form a basis for <m>\Col_n</m>.
      </p>
    </statement>
    <hint>
      <p>
        It is enough to show that those vectors are linearly independent. Why?
      </p>
    </hint>
    <hint>
      <p>
        Whenever you need to show that a set of vectors is linearly independent, you start by assuming that there is some linear relation
        <me>
          c_1[b_1]_{\basis{B}'}+\cdots+ c_n[b_n]_{\basis{B}'}=0
        </me>
        and try to show that <m>c_1=c2=\cdots=c_n=0</m>.
      </p>
    </hint>
    <hint>
      <p>
        Use the relations <m>c[b]_{\basis{B}'} = [cb]_{\basis{B}'}</m> and <m>[b_1]_{\basis{B}'}+[b_2]_{\basis{B}'} = [b_1+b_2]_{\basis{B}'}</m>.
      </p>
    </hint>
  </exercise>

 </exercises>

<solutions inline="statement answer solution">
  <title> Answers and solutions to Checkpoints in this section</title>
</solutions>

</section>

